# fly - Writeup

ゲームのチートを行う。  
ゲームデータが暗号化されているので、stringsなどでフラグは出てこない。  
まずはメモリを書き換えることによる主人公の座標の移動を試みる。  
CheatEngineなどがよく知られている。  
左右に動くことができるので以下の手順でX座標を特定する。  
- 初期値不明で検索  
- 以下を繰り返す  
  - 左に動き、値減少で検索(X座標を右が正だと予想)  
  - 右に動き、値増加で検索  
  - 5以上で値検索(X座標が一マスごとに1増えると予想、5マスより右にいるので)  
  - 100以下で値検索  

アイコンからWOLF RPGエディターと特定し、実際にゲームを作って解析してもよい。  
これらにより特定したX座標を書き換え、閉鎖空間から外に出ることに成功する。  
赤色の階段から別のマップに移動できるが、フラグはない。  
青色の階段があることから、移動できないマップがあると考えマップをメモリ上から探す。  
メモリダンプしてstringsにかけるとctf4b.mpsやflag1.mpsやflag2.mpsが見える(flagやゲーム名であるctf4bで検索)。  
どれかが移動できないマップである。  
すべて試せばよい。  
メモリ内のflag1.mpsをすべてflag2.mpsに書き換えると無事フラグがあるマップへ飛べる。  